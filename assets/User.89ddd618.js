import{r as n,I as L,J as K,j as U,o as a,c,k as r,p as C,F as v,l as q,m as b,u as g,K as z,n as F,a as $,b as h,d as J,e as R,f as P,g as A,L as G}from"./index.f71fd966.js";import{e as O}from"./post.6964797b.js";import{g as Q,d as W,p as X}from"./track.a304661e.js";import{s as Y,g as Z}from"./swal.db038e00.js";import{_ as ee,a as ae,p as se,d as te,b as re}from"./PostFilter.48e54c95.js";import{E as D}from"./EmptyPostCard.dd650f8a.js";import"./plugin-vue_export-helper.21dcd24c.js";const oe={class:"relative isolate mb-4 after:absolute after:right-1 after:top-1 after:z-[-1] after:h-full after:w-full after:rounded-lg after:border-2 after:border-black-100 after:content-['']"},le=P("\u8F09\u5165\u4E2D..."),ne={class:"min-h-[80px] w-[20%] flex-shrink-0 border-r-2 border-black-100 lg:w-[15%]"},ce=["src"],de={class:"flex flex-grow items-center p-4"},ie={class:"flex-grow pr-5"},ue={class:"font-bold"},ve=P("\u8F09\u5165\u4E2D..."),fe={key:0,class:"space-y-5"},ye={props:{userId:{type:String,required:!0}},setup(T){const s=T,f=n(!1),d=n(!1),m=n("desc"),y=n(""),u=n([]),o=n([]),l=n({}),{user:k}=A(),B=L(()=>k.value._id===s.userId),_=L(()=>u.value.some(e=>e._id===s.userId)),w=async e=>{try{f.value=!0,d.value=!0;const[t,i,p]=await Promise.all([Q(),G(e),x(e)]);u.value=t.data.map(j=>j.tracking),l.value=i.data,o.value=p.data}finally{f.value=!1,d.value=!1}},x=async e=>await O(e,{sort:m.value,q:y.value}),I=async()=>{d.value=!0;const{data:e}=await x(s.userId);o.value=e,d.value=!1},S=()=>{try{if(_.value){W(s.userId);const e=u.value.findIndex(t=>t._id===s.userId);u.value.splice(e,1),l.value.tracking--}else X(s.userId),u.value.push(l.value),l.value.tracking++}catch(e){Y({title:Z(e.message),icon:"error"})}},E=e=>{se({postId:e,userId:k.value._id,posts:o.value})},H=e=>{te({postId:e,userId:k.value._id,posts:o.value})},M=({postId:e,message:t})=>{re({postId:e,message:t,posts:o.value})},N=e=>{m.value=e,I()},V=e=>{y.value=e,I()};return K((e,t)=>{const{params:{userId:i}}=e;s.userId!==i&&w(i)}),w(s.userId),(e,t)=>{const i=U("img-avatar-fallback");return a(),c(v,null,[r("div",oe,[r("div",{class:C(["flex rounded-lg border-2 border-black-100 bg-white",{"min-h-[80px] items-center justify-center":f.value}])},[f.value?(a(),c(v,{key:0},[le],64)):(a(),c(v,{key:1},[r("div",ne,[q(r("img",{src:l.value.avatar,class:"h-full w-full rounded-l-lg object-cover",alt:"avatar"},null,8,ce),[[i]])]),r("div",de,[r("div",ie,[r("div",ue,b(l.value.name),1),r("p",null,b(g(z)(l.value.tracking))+" \u4EBA\u8FFD\u8E64",1)]),g(B)?F("",!0):(a(),c("button",{key:0,class:C(["flex-shrink-0 rounded-lg border-2 border-black-100 px-8 font-bold leading-8 text-black-100 shadow-200",g(_)?"bg-secondary":"bg-yellow-100"]),onClick:S},b(g(_)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3))])],64))],2)]),$(ee,{class:"mb-4",loading:d.value,sort:m.value,onChangeSort:N,onChangeKeyword:V},null,8,["loading","sort"]),d.value?(a(),h(D,{key:0},{default:J(()=>[ve]),_:1})):(a(),c(v,{key:1},[o.value.length?(a(),c("ul",fe,[(a(!0),c(v,null,R(o.value,p=>(a(),h(ae,{key:p._id,post:p,onPostLike:E,onPostMessage:M,onDeleteLike:H},null,8,["post"]))),128))])):(a(),h(D,{key:1}))],64))],64)}}};export{ye as default};
