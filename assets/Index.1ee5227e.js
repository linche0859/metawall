import{g as b}from"./post.2104c856.js";import{_ as C,a as E,p as M,d as B,b as N}from"./PostFilter.0cbfda63.js";import{r as t,o as S,a as V,b as s,c as l,d as y,e as p,w as $,F as m,f as D,_ as F,g as I,h as K,i as j}from"./index.e494dff4.js";import{E as k}from"./EmptyPostCard.5be2efba.js";import"./swal.db038e00.js";import"./plugin-vue_export-helper.21dcd24c.js";const q=K("\u8F09\u5165\u4E2D..."),T={key:0,class:"space-y-4"},U={key:2,class:"mt-5 flex justify-center"},Q={setup(W){const o=t(!0),n=t(!1),i=t("desc"),f=t(""),d=t(1),a=t([]),v=t({}),{user:g}=j(),r=async({isScrolling:e=!1,reset:u=!1}={})=>{try{e?n.value=!0:o.value=!0,u&&(d.value=1,a.value=[]);const{data:{data:c,meta:H}}=await b({sort:i.value,q:f.value,page:d.value});a.value.push(...c),v.value=H}finally{o.value=!1,n.value=!1}},w=e=>{M({postId:e,userId:g.value._id,posts:a.value})},h=e=>{B({postId:e,userId:g.value._id,posts:a.value})},L=({postId:e,message:u})=>{N({postId:e,message:u,posts:a.value})},P=e=>{i.value=e,r({reset:!0})},x=e=>{f.value=e,r({reset:!0})},_=()=>{o.value||n.value||v.value.currentPage>=v.value.lastPage||window.scrollY+window.innerHeight>=document.body.scrollHeight-100&&(d.value++,r({isScrolling:!0}))};return S(()=>{window.addEventListener("scroll",_)}),V(()=>{window.removeEventListener("scroll",_)}),r(),(e,u)=>(s(),l(m,null,[y(C,{class:"mb-4",loading:o.value,sort:i.value,onChangeSort:P,onChangeKeyword:x},null,8,["loading","sort"]),o.value?(s(),p(k,{key:0},{default:$(()=>[q]),_:1})):(s(),l(m,{key:1},[a.value.length?(s(),l("ul",T,[(s(!0),l(m,null,D(a.value,c=>(s(),p(E,{key:c._id,post:c,onPostLike:w,onPostMessage:L,onDeleteLike:h},null,8,["post"]))),128))])):(s(),p(k,{key:1}))],64)),n.value?(s(),l("div",U,[y(F,{color:"text-primary"})])):I("",!0)],64))}};export{Q as default};
