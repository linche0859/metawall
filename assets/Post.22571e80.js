import{r as o,q as x,b as d,c as p,k as a,l as m,z as k,v as _,x as w,g as y,d as F,n as C,w as j,y as z,F as B,h as f}from"./index.79882fa7.js";import{e as D}from"./post.fccce2e6.js";import{p as V}from"./file.ae3159b5.js";import{s as N,g as S}from"./swal.5a8fdb95.js";const U=a("h2",{class:"relative isolate mb-4 after:absolute after:right-1 after:top-1 after:z-[-1] after:h-full after:w-full after:border-2 after:border-black-100 after:content-['']"},[a("div",{class:"border-2 border-black-100 bg-white py-[18px] text-center font-azeret text-xl font-bold text-black-100"}," \u5F35\u8CBC\u52D5\u614B ")],-1),E=a("label",{for:"content",class:"mb-1 inline-block text-black-100"},"\u8CBC\u6587\u5167\u5BB9",-1),I={class:"relative mt-4 inline-block cursor-pointer rounded bg-black-100 py-1 px-8 text-white"},M=f(" \u4E0A\u50B3\u5716\u7247 "),P=["src"],R={key:0,class:"mt-8 text-center text-sm text-red-100","data-id":"error"},T=f("\u9001\u51FA\u8CBC\u6587"),G={setup(q){const i=o(!1),s=o(""),n=o(""),l=o(""),c=o(null),u=o(null),v=t=>{const e=t.target.files.item(0);if(l.value="",!["image/jpeg","image/png"].includes(e.type)){l.value="\u6A94\u6848\u683C\u5F0F\u932F\u8AA4\uFF0C\u50C5\u9650\u4E0A\u50B3 jpg\u3001jpeg \u8207 png \u683C\u5F0F",u.value.value="";return}const r=new FileReader;r.readAsDataURL(e),r.onload=()=>{n.value=r.result,c.value=e}},b=async()=>{try{const t=new FormData;t.append("image",c.value);const{data:e}=await V({payload:t});return e}catch(t){return Promise.reject(t)}},g=async()=>{i.value=!0;try{let t="";c.value&&(t=await b());const e={content:s.value};t&&(e.image=t),await D(e),s.value="",n.value="",l.value="",u.value.value="",c.value=null,N({title:"\u65B0\u589E\u8CBC\u6587\u6210\u529F"})}catch(t){const e=S(t.message);l.value=e}finally{i.value=!1}};return(t,e)=>{const r=x("Button");return d(),p(B,null,[U,a("form",{method:"post",class:"rounded-lg border-2 border-black-100 p-8 shadow-100",onSubmit:e[1]||(e[1]=z(()=>{},["prevent"]))},[E,m(a("textarea",{"onUpdate:modelValue":e[0]||(e[0]=h=>s.value=h),class:"block min-h-[169px] w-full border-2 border-black-100 py-3 px-4",placeholder:"\u8F38\u5165\u60A8\u7684\u8CBC\u6587\u5167\u5BB9"},null,512),[[k,s.value,void 0,{trim:!0}]]),a("label",I,[a("input",{ref_key:"inputFile",ref:u,type:"file",class:"sr-only",accept:"image/*",onChange:v},null,544),M]),m(a("img",{src:n.value,alt:"post image",class:"mt-4 rounded-lg object-cover"},null,8,P),[[_,n.value]]),l.value?(d(),p("p",R,w(l.value),1)):y("",!0),F(r,{class:C(["mx-auto block w-[68.86%] rounded-lg border-2 border-black-100 bg-gray-200 font-azeret font-bold leading-[50px] text-black-100 hover:bg-yellow-100 hover:shadow-200",l.value?"mt-4":"mt-8"]),loading:i.value,onClick:g},{default:j(()=>[T]),_:1},8,["class","loading"])],32)],64)}}};export{G as default};
